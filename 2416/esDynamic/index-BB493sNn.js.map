{"version":3,"file":"index-BB493sNn.js","sources":["../../src/fixtures/export-scalebar/index.ts"],"sourcesContent":["import { fabric } from 'fabric';\n\nimport { FixtureInstance } from '@/api/internal';\nimport type { ExportAPI, ExportSubFixture } from '@/fixtures/export/api/export';\nimport type { ExportConfig } from '../export/store';\n\nclass ExportScalebarFixture\n    extends FixtureInstance\n    implements ExportSubFixture\n{\n    get config(): any {\n        const fixtureConfig: ExportConfig | undefined =\n            this.$iApi.fixture.get<ExportAPI>('export').config;\n        return fixtureConfig?.mapElements;\n    }\n\n    make(options?: any): Promise<fabric.Object> {\n        const sInfo = this.$iApi.geo.map.caption.scaleHelper();\n        const fbObjs = [];\n\n        for (let i = 0; i < 2; i++) {\n            // create the fabric objects and group them\n            // scalebar layout (follows R2 layout):\n            //\n            //  <metric scale> km/m\n            //  ======================== (scale bar metric)\n            //  ============================== (scale bar imperial)\n            //  <imperial scale> mi/ft\n\n            const fbScaleText = new fabric.Text(\n                this.$iApi.$i18n.t('export.scaleBar.approx', [\n                    `${this.$iApi.$i18n.n(sInfo[i].distance, 'number')}${\n                        sInfo[i].units\n                    }`\n                ]),\n                {\n                    fontFamily:\n                        'Montserrat, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif',\n                    fill: '#000',\n                    fontSize: 16,\n                    top: i * 50,\n                    left: 0,\n                    originX: 'left',\n                    originY: 'top'\n                }\n            );\n            const fbScaleLine = new fabric.Line(\n                [0, i === 0 ? 30 : 40, sInfo[i].pixels, i === 0 ? 30 : 40],\n                {\n                    stroke: 'black',\n                    strokeWidth: 3\n                }\n            );\n\n            fbObjs.push(new fabric.Group([fbScaleLine, fbScaleText]));\n        }\n        return Promise.resolve(new fabric.Group(fbObjs, options));\n    }\n}\n\nexport default ExportScalebarFixture;\n"],"names":["ExportScalebarFixture","FixtureInstance","options","sInfo","fbObjs","i","fbScaleText","fabric","fbScaleLine"],"mappings":";;AAMA,MAAMA,UACMC,EAEZ;AAAA,EACI,IAAI,SAAc;AAGd,WADI,KAAK,MAAM,QAAQ,IAAe,QAAQ,EAAE,QAC1B;AAAA,EAC1B;AAAA,EAEA,KAAKC,GAAuC;AACxC,UAAMC,IAAQ,KAAK,MAAM,IAAI,IAAI,QAAQ,eACnCC,IAAS,CAAA;AAEf,aAASC,IAAI,GAAGA,IAAI,GAAGA,KAAK;AASlB,YAAAC,IAAc,IAAIC,EAAAA,OAAO;AAAA,QAC3B,KAAK,MAAM,MAAM,EAAE,0BAA0B;AAAA,UACzC,GAAG,KAAK,MAAM,MAAM,EAAEJ,EAAME,CAAC,EAAE,UAAU,QAAQ,CAAC,GAC9CF,EAAME,CAAC,EAAE,KACb;AAAA,QAAA,CACH;AAAA,QACD;AAAA,UACI,YACI;AAAA,UACJ,MAAM;AAAA,UACN,UAAU;AAAA,UACV,KAAKA,IAAI;AAAA,UACT,MAAM;AAAA,UACN,SAAS;AAAA,UACT,SAAS;AAAA,QACb;AAAA,MAAA,GAEEG,IAAc,IAAID,EAAAA,OAAO;AAAA,QAC3B,CAAC,GAAGF,MAAM,IAAI,KAAK,IAAIF,EAAME,CAAC,EAAE,QAAQA,MAAM,IAAI,KAAK,EAAE;AAAA,QACzD;AAAA,UACI,QAAQ;AAAA,UACR,aAAa;AAAA,QACjB;AAAA,MAAA;AAGG,MAAAD,EAAA,KAAK,IAAIG,SAAO,MAAM,CAACC,GAAaF,CAAW,CAAC,CAAC;AAAA,IAC5D;AACA,WAAO,QAAQ,QAAQ,IAAIC,EAAAA,OAAO,MAAMH,GAAQF,CAAO,CAAC;AAAA,EAC5D;AACJ;"}